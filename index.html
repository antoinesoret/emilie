<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Invitation â€“ Emilie</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.cdnfonts.com/css/brittany" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@400;600&display=swap" rel="stylesheet">

  <!-- Styles -->
  <style>
    :root{
      --accent-primary:#833947;
      --accent-secondary:#df9ac5;
      --accent-tertiary:#ca69a3;
      --bg-pink:#fdeef1;
      --font-main:'Josefin Sans',sans-serif;
      --font-title:'Brittany',cursive;
    }
    *,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
    html,body{height:100%;}
    body{
      font-family:var(--font-main);
      background:var(--bg-pink);
      color:#333;
      display:flex;flex-direction:column;
      min-height:100vh;
      overflow-x:hidden;
    }
    /* fixed floral bg */
    #bg-fixed{
      position:fixed;inset:0;
      background:url('floral-pattern.png') center/cover no-repeat;
      z-index:-1;
    }

    /* Generic helper */
    .hidden{display:none!important;}

    /* Password overlay */
    #login-overlay{
      position:fixed;inset:0;
      background:var(--bg-pink) url('floral-pattern.png') center/cover no-repeat;
      display:flex;justify-content:center;align-items:center;
      z-index:1000;
    }
    .modal{
      width:90%;max-width:480px;
      background:rgba(255,255,255,.95);
      padding:3rem 2rem;border-radius:2rem;
      box-shadow:0 16px 48px rgba(0,0,0,.2);
      text-align:center;
    }
    .modal h2{
      font-family:var(--font-title);
      font-size:2.5rem;
      color:var(--accent-primary);
      margin-bottom:2rem;
      letter-spacing:.05em;
    }
    .modal input{
      width:100%;padding:1rem;margin-bottom:1.5rem;
      border:2px solid var(--accent-secondary);
      border-radius:2rem;font-size:1.2rem;
    }
    .modal button{
      width:100%;padding:1rem;
      background:var(--accent-secondary);color:#fff;
      border:none;border-radius:2rem;
      font-size:1.2rem;font-weight:700;
      cursor:pointer;transition:opacity .2s;
    }
    .modal button:hover{opacity:.85;}
    .modal p.err{height:1.5rem;color:#c00;margin-top:.75rem;}

    /* Language toggle */
    .lang-toggle{
      position:fixed;top:1rem;right:1rem;z-index:900;
      display:flex;gap:.5rem;
    }
    .lang-toggle button{
      background:#fff;
      border:2px solid var(--accent-primary);
      color:var(--accent-primary);
      padding:.5rem 1rem;border-radius:2rem;
      font-weight:600;cursor:pointer;
    }
    .lang-toggle button.active,
    .lang-toggle button:hover{
      background:var(--accent-primary);color:#fff;
    }

    /* Header */
    header{text-align:center;padding:6rem 1rem 2rem;}
    header h1{
      font-family:var(--font-title);
      font-size:4rem;
      color:var(--accent-primary);
    }

    /* Desktop nav */
    nav{
      display:flex;gap:1rem;margin:2rem auto 0;max-width:90%;
    }
    nav button{
      flex:1;padding:1.25rem;
      background:#fff;border:none;border-radius:1rem;
      font-size:1.3rem;font-weight:600;
      cursor:pointer;
      box-shadow:0 6px 18px rgba(0,0,0,.12);
      transition:.3s;
    }
    nav button.active{background:var(--accent-tertiary);color:#fff;}
    nav button:hover:not(.active){background:var(--accent-secondary);color:#fff;}

    /* Mobile select dropdown */
    .mobile-select{display:none;}

    /* Mobile media query */
    @media (max-width:600px){
      nav{display:none!important;}
      .mobile-select{
        display:block;width:90%;max-width:360px;margin:1rem auto;
      }
      .mobile-select select{
        width:100%;padding:1rem;
        font-size:1.3rem;font-weight:600;
        border-radius:1rem;
        border:2px solid var(--accent-primary);
      }
      .tab-content{margin:1rem auto 5rem;}
    }

    /* Panels */
    .tab-content{flex:1;padding:2rem 1rem;}
    .tab-panel{
      display:none;
      max-width:800px;
      margin:1.5rem auto;
      background:rgba(255,255,255,.85);
      padding:2rem;
      border-radius:1rem;
      box-shadow:0 4px 16px rgba(0,0,0,.08);
      line-height:1.6;
    }
    .tab-panel.active{display:block;}

    .tab-panel h2{
      font-size:1.75rem;
      margin-bottom:1rem;
      color:var(--accent-primary);
      font-weight:600;
    }
    .tab-panel p{
      margin-bottom:1rem;font-size:1rem;
    }
    .tab-panel ul{margin:0;padding-left:1.5rem;margin-bottom:1.5rem;}
    .tab-panel ul li{margin-bottom:.75rem;font-size:1rem;line-height:1.6;}

    /* Location specific */
    #location img{
      width:100%;max-height:320px;object-fit:contain;border-radius:.5rem;margin-bottom:2rem;
    }
    #location iframe{
      width:100%;aspect-ratio:16/9;border:0;border-radius:.5rem;margin-bottom:2rem;
    }
    /* Day list style */
    #day-title{font-size:1.6rem;margin-bottom:1rem;color:var(--accent-primary);}
    .day ul{list-style:none;padding:0;}
    .day li{position:relative;padding-left:1.25rem;margin-bottom:1.75rem;font-size:1.25rem;line-height:1.8;}
    .day li::before{content:'â€¢';position:absolute;left:0;color:var(--accent-primary);}
  </style>

  <!-- âœ… SHAâ€‘256 polyfill (works in file:// and HTTP contexts) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/js-sha256/0.9.0/sha256.min.js"
          integrity="sha512-Wp2l++6wO14F9DRXk15BO0MQ5ZviPh9I9exb1pm+Yt5a8KUJqhcMXB+XDFpUdBy+6DmVkM8cSYvkW4qbIN8qbg=="
          crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body>
  <div id="bg-fixed"></div>

  <!-- Language toggle -->
  <div class="lang-toggle">
    <button data-lang="fr" class="active">FR</button>
    <button data-lang="de">DE</button>
  </div>

  <!-- Password overlay -->
  <div id="login-overlay">
    <div class="modal">
      <h2 id="auth-title">Entrez le mot de passe</h2>
      <input type="password" id="pass" placeholder="Mot de passe" autocomplete="current-password">
      <button id="login-btn">OK</button>
      <p id="err" class="err"></p>
    </div>
  </div>

  <!-- Protected content -->
  <div id="content" class="hidden">
    <header><h1 id="headline">Welcome Emilie</h1></header>

    <!-- Desktop nav -->
    <nav>
      <button data-tab="location" class="active">Lieu & Date</button>
      <button data-tab="day">JournÃ©e</button>
      <button data-tab="dresscode">Dresscode</button>
      <button data-tab="gift">Cadeau</button>
      <button data-tab="capsule">Time Capsule</button>
    </nav>

    <!-- Mobile nav -->
    <div class="mobile-select">
      <select id="mobile-select" aria-label="SÃ©lection de section">
        <option value="location">Lieu & Date</option>
        <option value="day">JournÃ©e</option>
        <option value="dresscode">Dresscode</option>
        <option value="gift">Cadeau</option>
        <option value="capsule">Time Capsule</option>
      </select>
    </div>

    <div class="tab-content">
      <section id="location" class="tab-panel active">
        <img src="location.jpeg" alt="Lieu">
        <p id="location-text"></p>
        <iframe id="location-map" src="" loading="lazy"></iframe>
      </section>
      <section id="day" class="tab-panel">
        <h2 id="day-title"></h2>
        <ul id="day-list"></ul>
      </section>
      <section id="dresscode" class="tab-panel">
        <h2 id="dresscode-title"></h2>
        <p id="dresscode-text"></p>
      </section>
      <section id="gift" class="tab-panel">
        <h2 id="gift-title"></h2>
        <p id="gift-link-text"></p>
        <p id="gift-iban-text"></p>
      </section>
      <section id="capsule" class="tab-panel">
        <h2 id="capsule-title"></h2>
        <p id="capsule-text"></p>
        <em id="capsule-note"></em>
      </section>
    </div>
  </div>

  <!-- Main script -->
  <script>
    /* ---------- Config ---------------------------------------*/
    const HASH='8746123202abcf57509bcf4a20b72268cdd94b60629d60d9a5c30bffd45f16d8';

    const translations={
      fr:{
        nav:['Lieu & Date','JournÃ©e','Dresscode','Cadeau','Time Capsule'],
        headline:'Welcome Emilie',
        locationText:`
          <p><strong>Quand :</strong> Samedi 16 aoÃ»t 2025, 13â€¯h</p>
          <p><strong>OÃ¹ :</strong> Cabane forestiÃ¨re d'Erlenbach<br/>Dachsbergwegâ€¯1, 8703 Erlenbach</p>
          <p><strong>Parking :</strong> Parking sur la route principale Â« Forchstrasse Â»</p>
          <p>La cabane n'est accessible qu'Ã  pied (env. 10â€¯min du parking).</p>
          <p>Le chemin est indiquÃ© par des ballons.</p>
          <p><strong>Inscription :</strong> Merci de nous dire avant le dimanche 15â€¯juinâ€¯2025 si vous venez.</p>
        `,
        locationMap:'https://www.google.com/maps/d/embed?mid=1Y6TPZ2S-fuc9uFztoCp0UiitNu6gQyU&usp=sharing',
        dayTitle:'JournÃ©e',
        dayItems:[
          '13â€¯hâ€¯00 â€“ ArrivÃ©e, accueil et rafraÃ®chissements',
          '13â€¯hâ€¯30 â€“ DÃ©but de la cÃ©rÃ©monie',
          '14â€¯hâ€¯20 â€“ ApÃ©ro suivi dâ€™un BBQ',
          'Open End'
        ],
        dresscodeTitle:'Code vestimentaire',
        dresscodeText:`
          <p><strong>COLORÃ‰ ET FLEURIâ€¯!!!</strong></p>
          <p>ThÃ¨me Â«â€¯Fleur de vieâ€¯Â»â€¯: Portez fleurs et couleurs.</p>
          <p><em>Hommes :</em> T-shirt/chemise Ã  fleurs et/ou fleur Ã  Ã©pingler.</p>
          <p><em>Femmes :</em> Robe/blouse/shirt Ã  fleurs et/ou couronne de fleurs.</p>
          <p>FÃªte en forÃªtâ€¯: Chaussures fermÃ©es recommandÃ©es, pantalon long pour les enfants.</p>
          <p>En cas de mauvais temps, intÃ©rieur de la cabane.</p>
        `,
        giftTitle:'Cadeaux',
        giftLinkText:'SÃ©lection de cadeauxâ€¯: <a href="https://happygiftlist.com/fr/wunschliste/ef8ji067" target="_blank">Link</a>',
        giftIbanText:'<strong>IBAN :</strong> Work In Progress',
        capsuleTitle:'Time Capsule',
        capsuleText:`
        <p>
          En lâ€™honneur du tout premier anniversaire de notre petite merveille,
          nous crÃ©ons une <strong>capsule temporelle</strong> quâ€™elle ouvrira
          le jour de ses 18&nbsp;ans.<br>
          Nous serions ravis que vous y glissiez un souvenir&nbsp;:
        </p>
      
        <ul>
          <li>un mot doux, un vÅ“u ou un conseil pour la vie adulte&nbsp;;</li>
          <li>une photo, un dessin ou un petit objet symbolique
              (plat, lÃ©ger et non pÃ©rissable).</li>
        </ul>
      
        <p>
          Scellez votre contribution dans une enveloppe fermÃ©e et signez-la
          (nom&nbsp;+&nbsp;date).<br>
          La boÃ®te sera cachetÃ©e Ã  la fin de la fÃªte et gardÃ©e prÃ©cieusement
          jusquâ€™en&nbsp;2042&nbsp;!
        </p>
      
        <p>
          Merci dâ€™avance de participer Ã  ce joli cadeau venu du passÃ© â€”
          elle sera Ã©mue de dÃ©couvrir, dans 17&nbsp;ans, lâ€™affection que vous
          lui portiez dÃ©jÃ  aujourdâ€™hui.&nbsp;ðŸ’Œ
        </p>
      `,
        capsuleNote:''
      },
      de:{
        nav:['Ort & Datum','Tagesablauf','Dresscode','Geschenk','Zeitkapsel'],
        headline:'Willkommen Emilie',
        locationText:`
          <p><strong>Wann :</strong> Samstag, 16.Â August 2025, 13Â Uhr</p>
          <p><strong>Wo :</strong> WaldhÃ¼tte Erlenbach<br/>DachsbergwegÂ 1, 8703 Erlenbach</p>
          <p><strong>Parken :</strong> Parkplatz an der Hauptstrasse Â«ForchstrasseÂ»</p>
          <p>HÃ¼tte nur zu Fuss (ca. 10Â Min. vom Parkplatz).</p>
          <p>Weg gekennzeichnet mit Luftballons.</p>
          <p><strong>Anmeldung :</strong> Bitte bis Sonntag, 15.Â JuniÂ 2025 Bescheid geben.</p>
        `,
        locationMap:'https://www.google.com/maps/d/embed?mid=1Y6TPZ2S-fuc9uFztoCp0UiitNu6gQyU&usp=sharing',
        dayTitle:'Tagesablauf',
        dayItems:[
          '13Â Uhr â€“ Eintreffen, BegrÃ¼ssung Ð¸ Erfrischungen',
          '13:30Â Uhr â€“ Beginn der Zeremonie',
          '14:20Â Uhr â€“ ApÃ©ro mit anschlieÃŸendem BBQ',
          'Open End'
        ],
        dresscodeTitle:'Dresscode',
        dresscodeText:`
          <p><strong>BUNT UND BLUMIG!!!</strong></p>
          <p>Motto Â«Blume des LebensÂ»â€¯: Blumen und Farben tragen.</p>
          <p><em>Herrenâ€¯:</em> Blumiges T-Shirt/Hemd und/oder Ansteckblume.</p>
          <p><em>Damenâ€¯:</em> Blumenkleid/Bluse/Shirt und/oder Blumenkranz.</p>
          <p>Feier im Waldâ€¯: geschlossene Schuhe empfohlen, lange Hosen fÃ¼r Kinder.</p>
          <p>Bei schlechtem Wetter innen in der HÃ¼tte.</p>
        `,
        giftTitle:'Geschenke',
        giftLinkText:'Geschenkelisteâ€¯: <a href="https://happygiftlist.com/de/wunschliste/ef8ji067" target="_blank">https://happygiftlist.com/de/wunschliste/ef8ji067</a>',
        giftIbanText:'<strong>IBAN :</strong> Work In Progress',
        capsuleTitle:'Zeitkapsel',
        capsuleText:'Work In Progress',
        capsuleNote:'-'
      }
    };

    /* ---------- State -----------------------------------------*/
    let lang='fr';

    /* ---------- Element refs ----------------------------------*/
    const loginOverlay=document.getElementById('login-overlay');
    const content=document.getElementById('content');
    const passInput=document.getElementById('pass');
    const loginBtn=document.getElementById('login-btn');
    const selectEl=document.getElementById('mobile-select');

    /* ---------- Utils -----------------------------------------*/
    async function calcHash(txt){
      if(window.crypto?.subtle && typeof TextEncoder!=='undefined'){
        const buf=await crypto.subtle.digest('SHA-256',new TextEncoder().encode(txt));
        return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,'0')).join('');
      }
      /* fallback: polyfill (synchronous) */
      return window.sha256(txt);
    }

    /* ---------- Unlock content --------------------------------*/
    function unlock(){
      loginOverlay.style.display='none';
      content.classList.remove('hidden');
      renderData();
      setupTabs();
      window.scrollTo({top:0});
    }

    /* ---------- Auth handling ---------------------------------*/
    async function handleLogin(){
      const val=passInput.value.trim();
      try{
        if(await calcHash(val)===HASH){
          unlock();
        }else{
          document.getElementById('err').textContent=
            lang==='fr'?'Mot de passe incorrect':'Falsches Passwort';
        }
      }catch(err){
        console.error(err);
        document.getElementById('err').textContent='Erreur technique â€“ rÃ©essayez';
      }
    }
    loginBtn.addEventListener('click',handleLogin);
    passInput.addEventListener('keydown',e=>{if(e.key==='Enter')handleLogin();});

    /* ---------- Language toggle -------------------------------*/
    document.querySelectorAll('.lang-toggle button').forEach(btn=>{
      btn.addEventListener('click',()=>{
        lang=btn.dataset.lang;
        document.documentElement.lang=lang;
        document.querySelectorAll('.lang-toggle button')
          .forEach(b=>b.classList.toggle('active',b===btn));
        if(!content.classList.contains('hidden'))renderData();
      });
    });

    /* ---------- Render dynamic text ---------------------------*/
    function renderData(){
      const t=translations[lang];
      /* headline */
      document.getElementById('headline').textContent=t.headline;
      /* nav buttons */
      document.querySelectorAll('nav button').forEach((btn,i)=>btn.textContent=t.nav[i]);
      /* mobile select labels */
      selectEl.querySelectorAll('option').forEach((opt,i)=>opt.textContent=t.nav[i]);
      /* content */
      document.getElementById('location-text').innerHTML=t.locationText;
      document.getElementById('location-map').src=t.locationMap;
      document.getElementById('day-title').textContent=t.dayTitle;
      const ul=document.getElementById('day-list');ul.innerHTML='';
      t.dayItems.forEach(it=>{const li=document.createElement('li');li.textContent=it;ul.append(li);});
      document.getElementById('dresscode-title').textContent=t.dresscodeTitle;
      document.getElementById('dresscode-text').innerHTML=t.dresscodeText;
      document.getElementById('gift-title').textContent=t.giftTitle;
      document.getElementById('gift-link-text').innerHTML=t.giftLinkText;
      document.getElementById('gift-iban-text').innerHTML=t.giftIbanText;
      document.getElementById('capsule-title').textContent=t.capsuleTitle;
      document.getElementById('capsule-text').innerHTML=t.capsuleText;
      document.getElementById('capsule-note').textContent=t.capsuleNote;
    }

    /* ---------- Tabs (desktop + mobile) -----------------------*/
    function setActiveTab(id){
      document.querySelectorAll('nav button').forEach(btn=>{
        btn.classList.toggle('active',btn.dataset.tab===id);
      });
      selectEl.value=id;
      document.querySelectorAll('.tab-panel').forEach(p=>{
        p.classList.toggle('active',p.id===id);
      });
      window.scrollTo({top:0});
    }
    function setupTabs(){
      /* desktop buttons */
      document.querySelectorAll('nav button')
        .forEach(btn=>btn.addEventListener('click',()=>setActiveTab(btn.dataset.tab)));
      /* mobile select */
      selectEl.addEventListener('change',e=>setActiveTab(e.target.value));
    }
  </script>
</body>
</html>
